                                                  计算机网络之TCP连接的四次挥手（释放）
                                                  
第一次挥手：发送方在想结束连接的时候，向接收方发送的一条报文。里面有FIN=1，代表了结束的意思，seq=u。

在第一次挥手之后，发送方进入结束等待1状态。

在接收端收到第一次挥手的报文之后，会发出一个报文，算是对于第一次回收的回应，也是对于这个请求的确认。包含了ACK=1，seq=v，ask=u+1。这是第二次挥手。

在收到第二次挥手之后，发送方就会进入结束等待2状态。

在接收方发出了第二个报文之后，就进入了关闭等待状态。在这个状态下，接收方还是可以进行数据传输的。这个主要是因为结束传输申请是发送方申请的，这也就意味着
发送方的数据已经传输完毕了，但是并不意味着接收方的数据也已经传输完毕了。所以在接收方进入关闭等待状态后，依旧可以进行数据传输。

在接收方将数据传输完之后，他又会发出一个报文，这个报文就是结束申请报文。告诉发送方他也可以结束传输了。并且还会带着一个ack=u+1，对于序列号进行确认。这
是第三次挥手。

在发送端接收倒第三次挥手之后，发送端也会发送一个报文到接收端。这就是第四次挥手，第四次挥手的意思就是确认你发送给我的信息我收到了，我们现在可以一起结束
连接状态了。

接收方在将我已将所有数据都传输完可以进行释放的报文之后，接受端就会进入到一个最后确认状态。

发送方在发送完第四次挥手之后，就会进入一个特殊的状态，就是时间等待状态，在这段时间内没有出现任何问题的情况下，他才会进入到关闭状态。

接收方在收到第四次挥手之后，就会进入关闭状态。

等待计时器：用于发送端的时间等待状态，等待的时间一般是两倍的最长报文寿命（MSL）。而最长报文寿命是两分钟，所以等待状态的持续时间就是四分钟。在这段等待
时间中，这个端口是不能使用的。

为什么需要等待2MSL

因为在这个时间等待状态下，实际上我们的第四次挥手还没有得到确认。

所以我们要确保我们的第四次挥手被接收端接收了。

在两个MSL还没有到达接收端的话，接收端就会重新发送第三次挥手。如果第三次报文没有被再次发送过来，就说明第四次挥手被收到了，也就说明可以结束连接了。

等待计时器还有第二个功能就是确保之前所有的报文都已经失效，不会对接下来的传输造成影响。
